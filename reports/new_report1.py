# -*- coding: utf-8 -*-
from docx import Document
from docx.shared import Pt, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.style import WD_STYLE_TYPE

doc = Document()

# Заголовок университета
p = doc.add_paragraph()
p.alignment = WD_ALIGN_PARAGRAPH.CENTER
run = p.add_run("МИНОБРНАУКИ РОССИИ\n")
run.font.size = Pt(12)
run.bold = True
run = p.add_run(
    "САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ\nЭЛЕКТРОТЕХНИЧЕСКИЙ УНИВЕРСИТЕТ\n«ЛЭТИ» ИМ. В.И. УЛЬЯНОВА (ЛЕНИНА)\n"
)
run.font.size = Pt(14)
run.bold = True
run = p.add_run("Кафедра ИС")
run.font.size = Pt(12)
run.bold = True

doc.add_paragraph()

# Название отчета
p = doc.add_heading("ОТЧЕТ", level=0)
p.alignment = WD_ALIGN_PARAGRAPH.CENTER
doc.add_heading("по лабораторной работе №1 и 2", level=1)
doc.add_paragraph(
    "по дисциплине «Системы поддержки принятия решений»", style="Intense Quote"
)

doc.add_paragraph()
title = doc.add_paragraph()
title.alignment = WD_ALIGN_PARAGRAPH.CENTER
run = title.add_run(
    "ТЕМА №52: БИЗНЕС-СЦЕНАРИЙ: ОРГАНИЗАЦИЯ РАБОТЫ ОТЕЛЯ ДЛЯ ДОМАШНИХ ЖИВОТНЫХ.\nBPMN2.0/DMN/CAMUNDA8/ZEEBE"
)
run.font.size = Pt(14)
run.bold = True

doc.add_paragraph()

# Студент и преподаватель
table = doc.add_table(rows=2, cols=2)
table.style = "Table Grid"
table.autofit = True
table.columns[0].width = Inches(3.5)
table.columns[1].width = Inches(3.5)

table.cell(0, 0).text = "Студент гр. 1378"
table.cell(0, 1).text = "Ханна М.Н."
table.cell(1, 0).text = "Преподаватель"
table.cell(1, 1).text = "Васильев Н.В."

doc.add_paragraph()
p = doc.add_paragraph("Санкт-Петербург\n2025")
p.alignment = WD_ALIGN_PARAGRAPH.CENTER

doc.add_page_break()

# 1. ЦЕЛЬ РАБОТЫ
doc.add_heading("1. ЦЕЛЬ РАБОТЫ", level=1)
doc.add_paragraph(
    "Целью данной работы является формализация бизнес-сценария «Отель для домашних животных» с использованием стандарта BPMN 2.0, "
    "с соблюдением использования только XOR и AND-шлюзов, подпроцессов и событий-таймеров, с последующим запуском процесса на движке Camunda Zeebe (л.р. 1).\n\n"
    "Вторая цель – использование инструментария имитационного моделирования (BIMP) для анализа производительности процесса. "
    "Это включает определение среднего времени цикла, стоимости ресурсов и выявление «узких мест» (bottlenecks) (л.р. 2).\n\n"
    "Наконец, на основе полученных результатов симуляции, применяются эвристики оптимизации для выработки предложений по улучшению процесса и распределения ресурсов."
)

# 2. СЦЕНАРИЙ
doc.add_heading("2. СЦЕНАРИЙ «ОТЕЛЬ ДЛЯ ДОМАШНИХ ЖИВОТНЫХ»", level=1)
doc.add_paragraph(
    "Процесс начинается с получения запроса на бронирование. Специалист по приему регистрирует бронь, после чего проверяется вакцинация. "
    "Если вакцинация недействительна — бронь отклоняется.\n\n"
    "Когда питомец прибывает, параллельно выполняются ветеринарный осмотр и размещение в номере. "
    "После этого запускается подпроцесс «Ежедневный уход» (кормление → прогулка → оценка совместимости → групповые или индивидуальные игры → ежедневный отчёт владельцу).\n\n"
    "За день до выезда срабатывает граничное событие-таймер и отправляется напоминание владельцу. "
    "По окончании пребывания выполняются: подготовка к отъезду, итоговый отчёт, выписка и сбор отзыва. "
    "Далее процесс разделяется на два параллельных потока: завершение для клиента и уборка номера хозяйственным отделом."
)

# 3. ХОД РАБОТЫ
doc.add_heading("3. ХОД РАБОТЫ (BPMN/DMN)", level=1)
doc.add_paragraph(
    "А. Диаграмма BPMN\n"
    "Диаграмма разработана в Camunda Modeler для Camunda 8 (Zeebe). Процесс разделён на 4 дорожки:\n"
    "1. Специалист по приему\n2. Ветеринар\n3. Специалист по уходу\n4. Хозяйственный отдел\n\n"
    "Б. Таблицы решений (DMN)\n"
    "Использованы две DMN-таблицы:\n"
    "• vaccination_check – проверка действительности вакцинации\n"
    "• pet_compatibility_check – определение возможности групповых игр (70% Да / 30% Нет)"
)

# 4. НАСТРОЙКА СИМУЛЯЦИИ
doc.add_heading("4. НАСТРОЙКА СИМУЛЯЦИИ (BIMP)", level=1)
doc.add_paragraph(
    "Симуляция проведена на 100 экземплярах процесса с интервалом прибытия 2 часа.\n\n"
    "Ресурсы и расписания:\n"
    "• Специалист по приему – 2 чел., 20 $/час, график Default (Пн-Пт 9–17)\n"
    "• Ветеринар – 1 чел., 40 $/час, график Default\n"
    "• Специалист по уходу – 3 чел., 18 $/час, график 24/7\n"
    "• Хозяйственный отдел – 2 чел., 16 $/час, график Default\n"
    "• Automated Service – 1, 0 $/час, 24/7\n\n"
    "Вероятности шлюзов:\n"
    "• «Вакцинация ОК?» – 90% Да / 10% Нет\n"
    "• «Совместим?» – 70% Да / 30% Нет"
)

# 5. АНАЛИЗ РЕЗУЛЬТАТОВ
doc.add_heading("5. АНАЛИЗ РЕЗУЛЬТАТОВ СИМУЛЯЦИИ", level=1)
doc.add_paragraph(
    "По результатам симуляции 100 экземпляров процесса получены следующие показатели:\n\n"
    "• Среднее время цикла (Avg. Cycle Time): 54 657 секунд = 15 часов 11 минут\n"
    "• Минимальное время цикла: 15 минут\n"
    "• Максимальное время цикла: 67 часов 25 минут (редкие случаи из-за длительного пребывания)\n"
    "• Среднее время выполнения задач внутри рабочего времени: 6 540 секунд (1 час 49 минут)\n\n"
    "• Время ожидания (Waiting Time) во всех задачах: 0 секунд — очереди полностью отсутствуют\n\n"
    "Загрузка ресурсов (Utilization):\n"
    "• Специалист по приему – 17.9%\n"
    "• Специалист по уходу – 30.3%\n"
    "• Ветеринар – 15.6%\n"
    "• Хозяйственный отдел – 11.7%\n\n"
    "Вывод: спроектированный процесс работает исключительно эффективно. Узких мест нет. "
    "Очереди не возникают даже при существующем графике работы ресурсов Default (9–17). "
    "Все ресурсы имеют значительный запас мощности."
)

# 6. ВЫВОДЫ
doc.add_heading("6. ВЫВОДЫ", level=1)
doc.add_paragraph(
    "1. Бизнес-процесс «Отель для домашних животных» успешно смоделирован как исполняемый процесс в Camunda 8 (Zeebe).\n\n"
    "2. Имитационное моделирование в BIMP показало выдающуюся производительность: среднее время обслуживания одного питомца составляет всего 15 часов 11 минут при максимальной загрузке ресурсов менее 31%.\n\n"
    "3. Процесс не содержит узких мест, очереди отсутствуют полностью, время ожидания = 0 секунд.\n\n"
    "4. Текущая конфигурация ресурсов и графиков работы является оптимальной. "
    "Дополнительные меры оптимизации (изменение графиков, увеличение персонала, перераспределение задач) не требуются.\n\n"
    "Процесс готов к промышленной эксплуатации в текущем виде."
)

# Сохранение файла
doc.save("Отчет_ЛР1-2_Ханна_1378_Правильный_2025.docx")
print("Отчет успешно создан: Отчет_ЛР1-2_Ханна_1378_Правильный_2025.docx")
